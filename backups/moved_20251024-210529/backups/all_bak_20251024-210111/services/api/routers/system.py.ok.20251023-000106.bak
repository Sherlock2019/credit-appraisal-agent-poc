# services/api/routers/system.py
from __future__ import annotations
import os, json
from fastapi import APIRouter

MODELS_ROOT = os.path.expanduser("~/demo-library/agents/credit_appraisal/models")
PROD_DIR = os.path.join(MODELS_ROOT, "production")

router = APIRouter(prefix="/v1/system", tags=["system"])

@router.get("/llms")
def list_llms():
    return {"models": ["phi3:3.8b", "mistral:7b-instruct", "gemma2:7b", "llama3:8b-instruct"]}

@router.get("/agents")
def list_agents():
    return [{"name": "credit_appraisal", "title": "Credit Appraisal Agent"}]

@router.get("/samples")
def list_samples():
    return {"credit_sample": "agents/credit_appraisal/sample_data/credit_sample.csv"}

@router.get("/production_meta")
def production_meta():
    mpath = os.path.join(PROD_DIR, "meta.json")
    if not os.path.exists(mpath):
        return {"has_production": False}
    with open(mpath, "r") as f:
        meta = json.load(f)
    meta["has_production"] = True
    return meta
