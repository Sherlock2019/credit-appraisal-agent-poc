# services/api/routers/system.py
from __future__ import annotations

import os
from fastapi import APIRouter
from fastapi.responses import JSONResponse

router = APIRouter()

@router.get("/v1/system/agents")
def list_agents():
    return JSONResponse({"agents": ["credit_appraisal"]})

@router.get("/v1/system/llms")
def list_llms():
    # Same labels as UI; API may map value→provider internally
    return JSONResponse({
        "models": [
            {"label": "Phi-3 Mini (3.8B) — CPU OK", "value": "phi3:3.8b"},
            {"label": "Mistral 7B Instruct — CPU slow / GPU OK", "value": "mistral:7b-instruct"},
            {"label": "Gemma-2 7B — CPU slow / GPU OK", "value": "gemma2:7b"},
            {"label": "LLaMA-3 8B — GPU recommended", "value": "llama3:8b-instruct"},
            {"label": "Qwen2 7B — GPU recommended", "value": "qwen2:7b-instruct"},
            {"label": "Mixtral 8x7B — GPU only (big)", "value": "mixtral:8x7b-instruct"},
        ]
    })

@router.get("/v1/system/samples")
def list_samples():
    root = os.path.expanduser("~/demo-library/agents/credit_appraisal/sample_data")
    if not os.path.isdir(root):
        return JSONResponse({"samples": []})
    files = [f for f in os.listdir(root) if f.lower().endswith(".csv")]
    return JSONResponse({"samples": files})
